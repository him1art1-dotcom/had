<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>الواجهة السحابية للمشرفين — حاضر</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/tokens.css" />
    <link rel="stylesheet" href="css/remote.css" />
  </head>
  <body>
    <div class="remote-shell">
      <header class="remote-header">
        <h1>بوابة التقارير السحابية للمشرفين</h1>
        <p>
          تتيح هذه الواجهة للمشرفين الوصول إلى قوائم الحضور، الغياب، والتأخر التي يصدرها جهاز تسجيل الطلاب بعد مشاركة
          البيانات من لوحة الإدارة. يمكنك تنزيل القوائم أو تحديثها فور وصول إشعار بمشاركة جديدة.
        </p>
      </header>

      <section class="connection-card">
        <form data-connection-form>
          <div class="connection-grid">
            <div class="field">
              <label for="remote-endpoint">رابط الخدمة السحابية</label>
              <input
                id="remote-endpoint"
                type="url"
                name="endpoint"
                placeholder="https://example.com/api/remote-report"
                required
                data-endpoint
              />
              <p class="form-hint">يجب أن يكون الرابط مطابقًا لما تم ضبطه في لوحة الإدارة.</p>
            </div>
            <div class="field">
              <label for="remote-school">رمز المدرسة</label>
              <input id="remote-school" type="text" name="school" autocomplete="off" required data-school-code />
            </div>
            <div class="field">
              <label for="remote-token">رمز الدخول (اختياري)</label>
              <input id="remote-token" type="text" name="token" autocomplete="off" placeholder="Bearer token" data-token />
              <p class="form-hint">استخدمه إذا تطلبت الخدمة مصادقة.</p>
            </div>
            <div class="field">
              <label for="remote-supervisor">نوع الإشراف</label>
              <select id="remote-supervisor" name="supervisor" data-supervisor>
                <option value="all">جميع المشرفين</option>
              </select>
              <p class="form-hint">اختر نطاق التقارير الذي ترغب في استعراضه.</p>
            </div>
            <div class="field">
              <label for="remote-day">تاريخ اليوم</label>
              <input id="remote-day" type="date" name="day" data-day />
            </div>
            <div class="field">
              <label class="checkbox">
                <input type="checkbox" name="autoRefresh" checked data-auto-refresh />
                <span>تحديث تلقائي عند وصول تقرير جديد</span>
              </label>
            </div>
          </div>
          <div class="connection-actions">
            <button type="submit" class="primary" data-fetch>تحديث التقرير الآن</button>
            <button type="button" class="secondary" data-download="present">تحميل قائمة الحضور</button>
            <button type="button" class="secondary" data-download="late">تحميل قائمة المتأخرين</button>
            <button type="button" class="secondary" data-download="absent">تحميل قائمة الغياب</button>
            <span class="status-label" data-status data-state="idle">جاهز للتحديث.</span>
          </div>
        </form>
      </section>

      <section class="remote-summary">
        <div class="summary-grid">
          <article class="summary-card">
            <h2 class="summary-card__label">إجمالي الطلاب</h2>
            <p class="summary-card__value" data-summary-total>0</p>
          </article>
          <article class="summary-card">
            <h2 class="summary-card__label">مسجلون حضورهم</h2>
            <p class="summary-card__value" data-summary-present>0</p>
          </article>
          <article class="summary-card summary-card--late">
            <h2 class="summary-card__label">متأخرون</h2>
            <p class="summary-card__value" data-summary-late>0</p>
          </article>
          <article class="summary-card summary-card--absent">
            <h2 class="summary-card__label">غائبون</h2>
            <p class="summary-card__value" data-summary-absent>0</p>
          </article>
        </div>
        <div class="summary-meta">
          <span>آخر مشاركة: <strong data-summary-generated>—</strong></span>
          <span>جدول المزامنة: <strong data-summary-schedule>—</strong></span>
        </div>
      </section>

      <section class="leave-card">
        <header class="leave-card__header">
          <div>
            <h2>إرسال طلب استئذان إلى الجهاز الرئيسي</h2>
            <p>
              استخدم هذا النموذج لرفع طلب خروج عاجل، وسيقوم الجهاز A بحفظه في قاعدة البيانات عند المزامنة القادمة.
            </p>
          </div>
        </header>
        <form class="leave-card__form" data-leave-form>
          <div class="leave-grid">
            <div class="field">
              <label for="leave-student-id">رقم الطالب</label>
              <input id="leave-student-id" type="text" inputmode="numeric" required data-leave-student-id />
            </div>
            <div class="field">
              <label for="leave-student-name">اسم الطالب (اختياري)</label>
              <input id="leave-student-name" type="text" data-leave-student-name />
            </div>
            <div class="field">
              <label for="leave-grade">الصف (اختياري)</label>
              <input id="leave-grade" type="text" data-leave-grade />
            </div>
            <div class="field">
              <label for="leave-class">الفصل (اختياري)</label>
              <input id="leave-class" type="text" data-leave-class />
            </div>
            <div class="field field--wide">
              <label for="leave-reason">سبب الاستئذان</label>
              <input id="leave-reason" type="text" required data-leave-reason />
            </div>
            <div class="field field--wide">
              <label for="leave-note">ملاحظات إضافية (اختياري)</label>
              <textarea id="leave-note" rows="3" data-leave-note></textarea>
            </div>
            <div class="field">
              <label for="leave-supervisor-name">اسم المشرف المرسل</label>
              <input id="leave-supervisor-name" type="text" required data-leave-supervisor-name />
              <p class="form-hint">يُحفظ لتعبئته تلقائيًا في المستقبل.</p>
            </div>
            <div class="field">
              <label for="leave-supervisor-contact">وسيلة التواصل (اختياري)</label>
              <input id="leave-supervisor-contact" type="text" data-leave-supervisor-contact />
            </div>
          </div>
          <div class="leave-actions">
            <button type="submit" class="primary" data-leave-submit>إرسال الطلب</button>
            <p class="status-label" data-leave-status data-state="idle">جاهز لإرسال الطلب.</p>
          </div>
        </form>
      </section>

      <section class="tables-section">
        <article class="table-card" data-table="present">
          <header>
            <h2>قائمة الحضور</h2>
            <button type="button" class="secondary" data-download="present">تنزيل CSV</button>
          </header>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>الرقم</th>
                  <th>الاسم</th>
                  <th>الصف</th>
                  <th>الفصل</th>
                  <th>وقت التسجيل</th>
                  <th>دقائق التأخر</th>
                </tr>
              </thead>
              <tbody data-table-body="present"></tbody>
            </table>
          </div>
          <div class="empty-state" data-empty-state="present">لا توجد بيانات مسجلة بعد.</div>
        </article>

        <article class="table-card" data-table="late">
          <header>
            <h2>قائمة المتأخرين</h2>
            <button type="button" class="secondary" data-download="late">تنزيل CSV</button>
          </header>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>الرقم</th>
                  <th>الاسم</th>
                  <th>الصف</th>
                  <th>الفصل</th>
                  <th>وقت التسجيل</th>
                  <th>دقائق التأخر</th>
                </tr>
              </thead>
              <tbody data-table-body="late"></tbody>
            </table>
          </div>
          <div class="empty-state" data-empty-state="late">لا توجد حالات تأخر مسجلة.</div>
        </article>

        <article class="table-card" data-table="absent">
          <header>
            <h2>قائمة الغياب</h2>
            <button type="button" class="secondary" data-download="absent">تنزيل CSV</button>
          </header>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>الرقم</th>
                  <th>الاسم</th>
                  <th>الصف</th>
                  <th>الفصل</th>
                  <th>وقت التسجيل</th>
                  <th>دقائق التأخر</th>
                </tr>
              </thead>
              <tbody data-table-body="absent"></tbody>
            </table>
          </div>
          <div class="empty-state" data-empty-state="absent">لا توجد بيانات غياب حتى الآن.</div>
        </article>
      </section>
      <footer class="site-footer">© جميع الحقوق محفوظة | أ. هيثم الزهراني | Him.Art</footer>
    </div>

    <div class="toast" data-toast data-state="hidden"></div>

    <script src="js/remote-sync.js" defer></script>
    <script src="js/remote.js" defer></script>
  </body>
</html>
